<div>
  <ul class="labels">
    <li class="waiting pm-color-gray pm-font-14">{{'WAITING' | translate}}</li>
    <li class="in-progress pm-color-gray pm-font-14">{{'IN_PROGRESS' | translate}}</li>
    <li class="finished pm-color-gray pm-font-14">{{'FINISHED' | translate}}</li>
  </ul>
</div>
<div *ngFor="let application of applications" class="pm-application-row"
     [ngClass]="{active: activeApplicationId === application.id}">
  <ul class="circles" (click)="activeApplicationId = (activeApplicationId === application.id ? null : application.id)">
    <li class="waiting">
      <div class="circle-item"
           [ngClass]="{active: checkApplicationsStatus(application, 'WAITING')}"
           [style.background-image]="checkApplicationsStatus(application, 'WAITING') ?
           'url(' + application.consumer.userData.avatar + ')' : null">
        <span class="pm-font-25"><i class="mdi mdi-check-circle-outline pm-color-white"></i></span>
      </div>
    </li>
    <li class="in-progress">
      <div class="circle-item"
           [ngClass]="{active: checkApplicationsStatus(application, 'IN_PROGRESS')}"
           [style.background-image]="checkApplicationsStatus(application, 'IN_PROGRESS') ?
           'url(' + application.consumer.userData.avatar + ')' : null">
        <span class="pm-font-25"><i class="mdi mdi-check-circle-outline pm-color-white"></i></span>
      </div>
    </li>
    <li class="finished">
      <div class="circle-item"
           [ngClass]="{active: checkApplicationsStatus(application, 'FINISHED')}"
           [style.background-image]="checkApplicationsStatus(application, 'FINISHED') ?
           'url(' + application.consumer.userData.avatar + ')' : null">
        <span class="pm-font-25"><i class="mdi mdi-check-circle-outline pm-color-white"></i></span>
      </div>
    </li>
  </ul>
  <div class="details" [hidden]="activeApplicationId !== application.id">
    <div class="columns">
      <div class="column is-4 pm-text-center">
        <div>
          <span class="pm-font-14 pm-color-gray pm-walker-application-status">
            {{application.consumer.userData.firstName}} {{application.consumer.userData.lastName}}
          </span><br/>
          <span class="pm-font-12 pm-color-gray pm-walker-application-status">
             {{application.status | translate}}
          </span>
        </div>
      </div>
      <div class="column is-8 pm-text-center">
        <button md-button>
          {{'open_conversation' | translate}}
        </button>
        <button md-button *ngIf="application.status === 'WAITING'
          && room.isOwner" (click)="onChangeStatus(application, 'IN_PROGRESS')">
          {{'confirm' | translate}}
        </button>
        <button md-button *ngIf="application.status === 'IN_PROGRESS'" (click)="onChangeStatus(application, 'FINISHED')">
          {{'finish' | translate}}
        </button>
        <button md-button color="warn" *ngIf="application.status === 'WAITING'"
                (click)="onChangeStatus(application, room.isOwner ? 'CANCELED_BY_PROVIDER' : 'CANCELED_BY_CONSUMER')">
          {{'cancel' | translate}}
        </button>
        <button md-button color="accent"
                *ngIf="application.status === 'FINISHED' && !room.isOwner && !room.rating"
                (click)="onRateClick(application)">
          {{'rate' | translate}}
        </button>
      </div>
    </div>
    <div class="columns">
      <div class="column">
        <div class="clearfix"></div>
        <div class="pm-font-12 pm-color-gray pm-text-right">{{application.createdAt | appFormatDate}}</div>
      </div>
    </div>
  </div>
</div>

